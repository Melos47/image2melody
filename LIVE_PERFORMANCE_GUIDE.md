# 🎬 实时演奏模式使用指南

## 🎮 新功能：动画像素化 + 实时演奏

### 功能概述

全新的实时演奏模式将图片像素化过程变成了一场互动音乐表演！程序会从左到右、从上到下逐个生成像素块，每个像素块立即播放对应的音符，同时您可以使用键盘实时控制音高，创造独特的8-bit音乐体验。

---

## 🎹 键盘控制

### 音高控制

| 按键 | 功能 | 音高变化 |
|------|------|----------|
| **W** | 升高八度 | +12 半音 |
| **S** | 降低八度 | -12 半音 |
| **A** | 降低半音 | -1 半音 |
| **D** | 升高半音 | +1 半音 |
| **Space** | 暂停/继续 | - |

### 使用技巧

```
💡 实时控制建议：

1. 在演奏过程中按住 W 键 → 整体音调升高（更明亮）
2. 在演奏过程中按住 S 键 → 整体音调降低（更低沉）
3. 使用 A/D 微调音高 → 创造渐进式音高变化
4. 按 Space 暂停 → 观察当前像素效果，然后继续
5. 尝试在不同颜色区域使用不同的音高设置
```

---

## 🎨 工作流程

### 1. 加载图片
```
点击 "📁 Load Image" → 选择图片
```
- 支持 PNG, JPG, JPEG, BMP, GIF
- 图片显示在左侧框架

### 2. 开始动画演奏
```
点击 "🎬 Start Animation"
```
- 程序开始从 (0,0) 位置像素化
- 每个 8x8 像素块按序生成
- 同时播放对应音符
- 可以立即使用 WASD 控制

### 3. 实时交互
```
演奏过程中：
• 观察左侧像素块逐渐填充
• 听到对应的8-bit音符
• 用 WASD 调整音高
• 右侧显示实时进度
```

### 4. 完成后操作
```
演奏完成后可以：
• 🔄 Replay Animation - 重新演奏
• 🎼 Generate Melody - 生成完整MIDI
• 💾 Save MIDI - 保存文件
```

---

## 🎵 像素到音符的映射

### RGB → 音乐参数

每个 8x8 像素块的颜色决定音符特性：

```python
像素块颜色: (R, G, B)
    ↓
基础音符:
├── Pitch (音高)    ← 红色值 (0-255)
├── Duration (时长) ← 绿色值 (0-255) → 50-200ms
└── Velocity (力度) ← 蓝色值 (0-255) → 60-127

    ↓ + 您的键盘控制
    
最终音高 = 基础音高 + 八度偏移
```

### 音高范围

- **基础范围**: C4 - C6 (MIDI 60-84)
- **可调范围**: ±24 半音 (2个八度)
- **最终范围**: A1 - C8 (MIDI 21-108)

---

## 🎬 动画过程

### 像素生成顺序

```
开始 (0,0)
  ↓
[■][□][□][□][□]...  ← 第一行，从左到右
[□][□][□][□][□]...
[□][□][□][□][□]...
...
  ↓
[■][■][■][■][■]...  ← 第一行完成
[■][□][□][□][□]...  ← 第二行开始
[□][□][□][□][□]...
...
  ↓
[■][■][■][■][■]...
[■][■][■][■][■]...
[■][■][■][■][■]...  ← 全部完成
```

### 时间控制

每个像素块的显示时间由其绿色值决定：
- G=0: 50ms (快速)
- G=128: 125ms (中速)
- G=255: 200ms (慢速)

---

## 📊 界面信息

### 演奏前
```
🎬 Live Performance Started!
==================================================

Original Size: 640 x 480 pixels
Grid Size: 80 x 60
Total Blocks: 4800
Pixel Block Size: 8x8

🎹 Use WASD to control pitch during performance!
  W = Up octave (+12)
  S = Down octave (-12)
  A = Down semitone (-1)
  D = Up semitone (+1)
  Space = Pause/Resume

Each pixel block will play a note as it appears...
```

### 演奏中
```
状态栏:
Playing... Block (45,23) [1234/4800] 25.7%

音高显示:
♪ Octave Shift: +12 semitones
```

### 演奏后
```
🎉 Performance Complete!
==================================================

Total blocks played: 4800
Final octave shift: +7 semitones

You can:
• Click 'Replay Animation' to perform again
• Click 'Generate Melody' to create a full MIDI file
• Load a new image to start over
```

---

## 🎮 互动示例

### 场景1: 随着图片渐变调整音高

```
图片：日落场景（从亮到暗）

操作：
1. 开始时按住 W → 明亮部分音调升高
2. 中间部分松开按键 → 使用原始音高
3. 暗部按住 S → 低沉的音调

效果：音乐跟随视觉的明暗变化！
```

### 场景2: 创造和弦效果

```
操作：
1. 前1/4按 W → 高音部
2. 中间1/2不按 → 中音部
3. 后1/4按 S → 低音部

效果：三段式和声变化
```

### 场景3: 实时即兴演奏

```
操作：
边看边玩，根据颜色直觉调整：
• 看到红色 → 按 W (更热烈)
• 看到蓝色 → 按 S (更冷静)
• 看到绿色 → 按 A/D (微调)

效果：完全个性化的音乐作品！
```

---

## 🔧 高级技巧

### 1. 创造音乐结构

```
A段: 不按键 → 原始旋律
B段: 按 W → 升高八度
A段: 松开 → 回到原始
C段: 按 S → 降低八度

结构: A-B-A-C (经典音乐形式)
```

### 2. 动态对比

```
开始: 按住 S → 轻柔低音
高潮: 切换到 W → 高亢明亮
结束: 回到中音 → 平和收尾
```

### 3. 节奏感控制

```
使用 Space 键：
• 在关键像素块前暂停
• 营造音乐中的"休止符"
• 继续播放产生律动感
```

---

## 💡 创意玩法

### 1. 故事配乐
为图片讲故事，用音高变化表现情节起伏

### 2. 颜色交响
不同颜色区域使用不同八度，创造层次感

### 3. 即兴挑战
闭眼演奏，完全凭听觉调整音高

### 4. 协作创作
一人选图片，一人控制键盘，共同创作

---

## 🎼 从演奏到作品

### 完整创作流程

```
1. 🎬 实时演奏
   ↓ (找到最佳音高设定)
   
2. 记录您的控制模式
   ↓ (例如："前半段 +12，后半段 -6")
   
3. 🔄 重放并调整
   ↓ (多次尝试找到完美效果)
   
4. 🎼 生成 MIDI
   ↓ (保存最终版本)
   
5. 💾 保存作品
   ↓ (可在DAW中进一步编辑)
```

---

## 🐛 故障排除

### 没有声音
```
可能原因：
• MIDI设备未初始化
• 系统音量关闭
• 音频驱动问题

解决方法：
1. 重启程序
2. 检查系统音量
3. 尝试其他图片
```

### 按键不响应
```
可能原因：
• 窗口失去焦点

解决方法：
点击程序窗口确保焦点在应用上
```

### 动画卡顿
```
可能原因：
• 图片过大
• 系统资源不足

解决方法：
使用较小的图片 (建议 < 1MB)
```

---

## 🎨 推荐图片类型

### 最佳效果

✅ **色彩丰富的抽象画** → 多变的旋律
✅ **渐变图案** → 平滑的音高过渡  
✅ **几何图形** → 规律的节奏感
✅ **风景照片** → 自然的音乐流动

### 实验性

🔬 **黑白照片** → 极简主义风格
🔬 **像素艺术** → 复古游戏音效
🔬 **名画作品** → 艺术化演绎

---

## 📝 技术细节

### 实时音频

- 使用 `pygame.midi` 实现
- MIDI设备输出 (通道0)
- 乐器: 方波 (Program 80)
- 延迟: 50-200ms/音符

### 像素化算法

```python
1. 原图 → 缩小到网格尺寸
2. 提取每个网格点的RGB
3. 按行扫描 (左→右, 上→下)
4. 每个点 → 8x8像素块填充
5. 同步播放对应音符
```

---

**享受实时创作的乐趣！** 🎵🎨✨

每次演奏都是独一无二的音乐体验！
